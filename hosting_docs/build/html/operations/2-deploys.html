

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Hosting Considerations &mdash; CommCareHQ Deployment  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CommCareHQ Deployment
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about/about-docs.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/about-docs.html#a-word-of-caution">A word of caution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation/prereqs/1-considerations.html">Deploy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/prereqs/1-considerations.html#commcare-cluster-management">CommCare Cluster Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/prereqs/1-considerations.html#many-processes">Many processes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/prereqs/1-considerations.html#physical-server-management">Physical Server Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/prereqs/1-considerations.html#network-connection">Network Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/prereqs/1-considerations.html#power-source">Power Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/prereqs/1-considerations.html#physical-security">Physical Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/prereqs/1-considerations.html#temperature-control">Temperature Control</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="1-overview.html">Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="1-overview.html#commcare-cluster-management">CommCare Cluster Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="1-overview.html#many-processes">Many processes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="1-overview.html#physical-server-management">Physical Server Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="1-overview.html#network-connection">Network Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-overview.html#power-source">Power Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-overview.html#physical-security">Physical Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-overview.html#temperature-control">Temperature Control</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scaling/1-overview.html">Scaling Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scaling/1-overview.html#commcare-cluster-management">CommCare Cluster Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scaling/1-overview.html#many-processes">Many processes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scaling/1-overview.html#physical-server-management">Physical Server Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scaling/1-overview.html#network-connection">Network Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scaling/1-overview.html#power-source">Power Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scaling/1-overview.html#physical-security">Physical Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scaling/1-overview.html#temperature-control">Temperature Control</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/0-overview.html">Reference Material</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/0-overview.html#commcare-cluster-management">CommCare Cluster Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/0-overview.html#many-processes">Many processes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/0-overview.html#physical-server-management">Physical Server Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/0-overview.html#network-connection">Network Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/0-overview.html#power-source">Power Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/0-overview.html#physical-security">Physical Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/0-overview.html#temperature-control">Temperature Control</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CommCareHQ Deployment</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Hosting Considerations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/operations/2-deploys.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hosting-considerations">
<h1>Hosting Considerations<a class="headerlink" href="#hosting-considerations" title="Permalink to this headline">¶</a></h1>
<p>If you are interested in running a CommCare server environment there are
a number of serious obstacles to consider before taking the plunge. If
you are already managing a CommCare server environment and are finding
it challenging, you may also find thinking about the considerations
listed here helpful before deciding your next steps.</p>
<div class="section" id="commcare-cluster-management">
<h2>CommCare Cluster Management<a class="headerlink" href="#commcare-cluster-management" title="Permalink to this headline">¶</a></h2>
<p>CommCare HQ is a complex, distributed software application, made up of
dozens of processes and several pieces of third-party open source
database software. It has been built for scale rather than simplicity,
and as a result even for small deployments a CommCare server or server
cluster can be challenging to maintain.</p>
<div class="section" id="many-processes">
<h3>Many processes<a class="headerlink" href="#many-processes" title="Permalink to this headline">¶</a></h3>
<p>While the setup automation should work out of the box, once you’re up
and running you will have to troubleshoot any issues yourself. This
means being familiar enough with every piece of third-party database
software to be able to debug issues and bring it back to life or recover
from some other bad state; it also means understanding what each of the
many types of CommCare application processes does well enough to
troubleshoot issues.</p>
<p>CommCare HQ relies on the following open source technologies:</p>
<ul class="simple">
<li><p>PostgreSQL</p></li>
<li><p>PL/Proxy and a custom sharding setup</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pg_backup</span></code> and streaming replication</p></li>
<li><p>CouchDB</p></li>
<li><p>Redis</p></li>
<li><p>Riak/Riak CS (mandatory for multi-server environments)</p></li>
<li><p>Elasticsearch</p></li>
<li><p>Kafka (and Zookeeper)</p></li>
<li><p>RabbitMQ</p></li>
<li><p>Nginx</p></li>
</ul>
<p>CommCare HQ also employs different types of application processes each
with its own distinct purpose and set of functionality:</p>
<ul class="simple">
<li><p>Web workers</p></li>
<li><p>Asynchronous task processors (Celery)</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Extract,_transform,_load">ETL</a>
processes (“Pillowtop”) that themselves come in a number of different
flavors and fill a number of different roles</p></li>
<li><p>The CommCare mobile engine exposed as a webservice (“Formplayer”)</p></li>
</ul>
<p>You will also need some familiarity with the following sysadmin tools:</p>
<ul class="simple">
<li><p>Monit</p></li>
<li><p>Supervisor</p></li>
<li><p>Ansible</p></li>
<li><p>Fabric</p></li>
<li><p>EcryptFS</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Logical_Volume_Manager_%28Linux%29">LVM</a>
(optional)</p></li>
</ul>
</div>
</div>
<div class="section" id="physical-server-management">
<h2>Physical Server Management<a class="headerlink" href="#physical-server-management" title="Permalink to this headline">¶</a></h2>
<p>This section is for people interested in owning the physical hardware
running their servers. If you will be using an established data center
or modern hosting provider, this doesn’t apply.</p>
<p>It can be tempting to want to run CommCare HQ on server hardware that
you own. After all, a server is just a computer connected to the
internet, with enough RAM, CPU, and Disk to run the software it’s
hosting. However, in practice, there’s a lot more that goes into it.</p>
<div class="section" id="network-connection">
<h3>Network Connection<a class="headerlink" href="#network-connection" title="Permalink to this headline">¶</a></h3>
<p>One of the biggest difficulties in maintaining physical server hardware
is that to be reliable it must <strong>always</strong> be connected to the internet
over a stable and reliable network. In many of the areas of the world
that are most interested in self-hosting for data-sovereignty reasons,
network connectivity is notoriously spotty. Real data centers will go to
great lengths to keep their servers always connected to the public
internet, including network redundancy. It can be close to impossible to
do this at the level of one or two servers in an office, so in practice,
these servers will experience large rates of downtime.</p>
</div>
<div class="section" id="power-source">
<h3>Power Source<a class="headerlink" href="#power-source" title="Permalink to this headline">¶</a></h3>
<p>Another often-overlooked challenge with managing physical hardware is
maintaining a reliable power source. In many areas of the world that use
CommCare, reliable power is not a given. Even with a generator, unless
there’s a sophisticated battery backup system in place, it will take a
number of seconds for the generator to kick in, and even the slightest
blip in power supply will cause a server to shut off without warning.
Thus, without a well-planned system in place for maintaining consistent
power even through a grid outage, these servers will experience a lot of
downtime and will be at risk for data corruption as a result of powering
off without warning.</p>
</div>
<div class="section" id="physical-security">
<h3>Physical Security<a class="headerlink" href="#physical-security" title="Permalink to this headline">¶</a></h3>
<p>Real data centers are highly guarded by security personnel and have
authorization protocols preventing physical access to the servers except
by a small handful of entrusted individuals. With physical access to a
machine, a malicious or unwitting person can steal private information
or cause untold damage including deletion of all data. In the typical
office environment, maintaining an appropriate level of physical
security around the hardware is not a given, and will require concerted
effort and planning.</p>
</div>
<div class="section" id="temperature-control">
<h3>Temperature Control<a class="headerlink" href="#temperature-control" title="Permalink to this headline">¶</a></h3>
<p>Computer hardware gives off a tremendous amount of heat. Servers are
<strong>hot</strong>, and so are many of the areas of the world that use CommCare.
Real data centers are carefully designed to manage heat flow and sites
are often specifically chosen for environmental features such as cold
outdoor temperature or proximity to a vast water source for cooling.
Overheating is a very real issue and when it happens it will lead to
unpredictable hardware failure.</p>
<hr class="docutils" />
<p><a class="reference external" href="..">︎⬅︎ Overview</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Dimagi Inc.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>